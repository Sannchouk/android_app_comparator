import{m as e,a8 as t,g as i,ac as n,C as c,r as a,ap as l,aE as r}from"./main.js";function o(e,t){return l("hourglass"===e?Math.round(t):Math.floor(t))}function m(e){return void 0!==e.whiteMoves}function s(l,r){return{none:()=>"",simple:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.simple.time,!1,r))),increment:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.increment.time,!1,r)),e("div",{className:"select_input"},t.renderSelect("Increment","increment",i.clock.availableIncrements.map(n),i.clock.increment.increment,!1,r))),handicapInc:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"handicapRow"},e("div",{className:"handicapRowTitle"},"Top"),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect("Time","topTime",i.clock.availableTimes,i.clock.handicapInc.topTime,!1,r)),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect("Increment","topIncrement",i.clock.availableIncrements.map(n),i.clock.handicapInc.topIncrement,!1,r))),e("div",{className:"handicapRow"},e("div",{className:"handicapRowTitle"},"Bottom"),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect("Time","bottomTime",i.clock.availableTimes,i.clock.handicapInc.bottomTime,!1,r)),e("div",{className:"select_input inline handicapRowMember"},t.renderSelect("Increment","bottomIncrement",i.clock.availableIncrements.map(n),i.clock.handicapInc.bottomIncrement,!1,r)))),delay:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.delay.time,!1,r)),e("div",{className:"select_input"},t.renderSelect("Increment","increment",i.clock.availableIncrements.map(n),i.clock.delay.increment,!1,r))),bronstein:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.bronstein.time,!1,r)),e("div",{className:"select_input"},t.renderSelect("Increment","increment",i.clock.availableIncrements.map(n),i.clock.bronstein.increment,!1,r))),hourglass:()=>e("div",{className:"clockSettingParameters"},e("div",{className:"select_input"},t.renderSelect("Time","time",i.clock.availableTimes,i.clock.hourglass.time,!1,r))),stage:()=>e("div",{className:"clockSettingParameters"},i.clock.stage.stages().map(((l,o)=>function(l,r){const o=u.bind(void 0,r),m=g.bind(void 0,r),s=i.clock.stage.stages().length>=5,d=i.clock.stage.stages().length<=2;return e("div",{className:"stageRow"},e("div",{className:"stageRowTitle"},r+1),e("div",{className:"select_input inline stage stageRowMember"},t.renderSelect("Time","time",i.clock.availableTimes,o,!1,l)),e("div",{className:"select_input inline stage stageRowMember"+(r===i.clock.stage.stages().length-1?" lastStage":"")},t.renderSelect("Moves","moves",i.clock.availableMoves.map(n),m,!1,l)),e("div",{className:"stageRowMember addSubtractStage"+(r===i.clock.stage.stages().length-1?" lastStage":"")},e("span",{className:"fa fa-plus-square-o"+(s?" hiddenButton":""),oncreate:c((()=>function(e){const t=e();t[t.length-1].moves=t[t.length-2].moves,t.push({time:t[t.length-1].time,moves:null}),e(t),a()}(i.clock.stage.stages)))})," ",e("span",{className:"fa fa-minus-square-o"+(d?" hiddenButton":""),oncreate:c((()=>function(e){const t=e();t.length<=2||(t.pop(),e(t),a())}(i.clock.stage.stages)))})))}(r,o))),e("div",{className:"select_input"},t.renderSelect("Increment","increment",i.clock.availableIncrements.map(n),i.clock.stage.increment,!1,r)))}[l]()}function u(e,t){const n=i.clock.stage.stages();return t&&(n[e].time=t,i.clock.stage.stages(n)),n[e].time}function g(e,t){const n=i.clock.stage.stages();return t&&(n[e].moves=t,i.clock.stage.stages(n)),n[e].moves}function d(e,t,i,n,c,l){let o,m,s,u={clockType:"handicapInc",whiteTime:0!==e?e:t,blackTime:0!==i?i:n,whiteIncrement:t,blackIncrement:n,activeSide:void 0,flagged:void 0,isRunning:!1};function g(){const e=performance.now();if("white"===d()){const t=e-m;m=e,u.whiteTime=Math.max(u.whiteTime-t,0),k()<=0&&(u.flagged="white",c(u.flagged),l&&r.dong(),clearInterval(o))}else if("black"===d()){const t=e-s;s=e,u.blackTime=Math.max(u.blackTime-t,0),h()<=0&&(u.flagged="black",c(u.flagged),l&&r.dong(),clearInterval(o))}a()}function d(){return u.activeSide}function v(){return u.flagged}function f(){return u.isRunning}function k(){return u.whiteTime}function h(){return u.blackTime}return{clockType:"handicapInc",getState:function(){return u},setState:function(e){u=e},activeSide:d,flagged:v,isRunning:f,clockHit:function(e){v()||(l&&r.clock(),"white"===e?("white"===d()&&(u.whiteTime=u.whiteTime+u.whiteIncrement),s=performance.now(),u.activeSide="black"):"black"===e&&("black"===d()&&(u.blackTime=u.blackTime+u.blackIncrement),m=performance.now(),u.activeSide="white"),clearInterval(o),o=setInterval(g,100),u.isRunning=!0,a())},startStop:function(){f()?(clearInterval(o),u.isRunning=!1):(u.isRunning=!0,"white"===d()?m=performance.now():s=performance.now(),o=setInterval(g,100))},whiteTime:k,blackTime:h,getTime:function(e){return"white"===e?k():h()},toggleActiveSide:function(){u.activeSide&&("white"===u.activeSide?(s=performance.now(),u.activeSide="black"):(m=performance.now(),u.activeSide="white"))},clear(){clearInterval(o)}}}function v(e,t,i){return d(e,t,e,t,i,!0)}var f={simple:e=>function(e,t){return v(e,0,t)}(6e4*Number(i.clock.simple.time()),e),increment:e=>v(6e4*Number(i.clock.increment.time()),1e3*Number(i.clock.increment.increment()),e),handicapInc:e=>d(6e4*Number(i.clock.handicapInc.topTime()),1e3*Number(i.clock.handicapInc.topIncrement()),6e4*Number(i.clock.handicapInc.bottomTime()),1e3*Number(i.clock.handicapInc.bottomIncrement()),e,!0),delay:e=>function(e,t,i,n){let c,l,o,m={clockType:"delay",whiteTime:0!==e?e:t,blackTime:0!==e?e:t,whiteDelay:t,blackDelay:t,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function s(){const e=performance.now();if("white"===u()){const t=e-l;l=e,Math.floor(m.whiteDelay)>0?m.whiteDelay=m.whiteDelay-t:(m.whiteTime=Math.max(m.whiteTime-t,0),m.whiteTime<=0&&(m.flagged="white",i(m.flagged),n&&r.dong(),clearInterval(c)))}else if("black"===u()){const t=e-o;o=e,m.blackDelay>0?m.blackDelay=m.blackDelay-t:(m.blackTime=Math.max(m.blackTime-t,0),v()<=0&&(m.flagged="black",i(m.flagged),n&&r.dong(),clearInterval(c)))}a()}function u(){return m.activeSide}function g(){return m.flagged}function d(){return m.whiteTime}function v(){return m.blackTime}return{clockType:"delay",getState:function(){return m},setState:function(e){m=e},activeSide:u,flagged:g,isRunning:function(){return m.isRunning},clockHit:function(e){g()||(n&&r.clock(),"white"===e?("white"===m.activeSide&&(m.blackDelay=m.increment),o=performance.now(),m.activeSide="black"):"black"===e&&("black"===m.activeSide&&(m.whiteDelay=m.increment),l=performance.now(),m.activeSide="white"),clearInterval(c),c=setInterval(s,100),m.isRunning=!0,a())},startStop:function(){m.isRunning?(m.isRunning=!1,clearInterval(c)):(m.isRunning=!0,c=setInterval(s,100),"white"===u()?l=performance.now():o=performance.now())},whiteTime:d,blackTime:v,getTime:function(e){return"white"===e?d():v()},toggleActiveSide:function(){m.activeSide&&("white"===m.activeSide?(o=performance.now(),m.activeSide="black"):(l=performance.now(),m.activeSide="white"))},clear(){clearInterval(c)}}}(6e4*Number(i.clock.delay.time()),1e3*Number(i.clock.delay.increment()),e,!0),bronstein:e=>function(e,t,i,n){let c,l,o,m={clockType:"bronstein",whiteTime:0!==e?e:t,blackTime:0!==e?e:t,whiteDelay:t,blackDelay:t,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function s(){const e=performance.now();if("white"===m.activeSide){const t=e-l;l=e,m.whiteTime=Math.max(m.whiteTime-t,0),m.whiteDelay=Math.max(m.whiteDelay-t,0),m.whiteTime<=0&&(m.flagged="white",i(m.flagged),n&&r.dong(),clearInterval(c))}else if("black"===u()){const t=e-o;o=e,m.blackTime=Math.max(m.blackTime-t,0),m.blackDelay=Math.max(m.blackDelay-t,0),m.blackTime<=0&&(m.flagged="black",i(m.flagged),n&&r.dong(),clearInterval(c))}a()}function u(){return m.activeSide}function g(){return m.whiteTime}function d(){return m.blackTime}return{clockType:"bronstein",getState:function(){return m},setState:function(e){m=e},activeSide:u,flagged:function(){return m.flagged},isRunning:function(){return m.isRunning},clockHit:function(e){m.flagged||(n&&r.clock(),"white"===e?("white"===m.activeSide&&(m.whiteTime=m.whiteTime+(m.increment-m.whiteDelay),m.blackDelay=m.increment),o=performance.now(),m.activeSide="black"):("black"===m.activeSide&&(m.blackTime=m.blackTime+(m.increment-m.blackDelay),m.whiteDelay=m.increment),l=performance.now(),m.activeSide="white"),c&&clearInterval(c),c=setInterval(s,100),m.isRunning=!0,a())},startStop:function(){m.isRunning?(m.isRunning=!1,clearInterval(c)):(m.isRunning=!0,c=setInterval(s,100),"white"===m.activeSide?l=performance.now():o=performance.now())},whiteTime:g,blackTime:d,getTime:function(e){return"white"===e?g():d()},toggleActiveSide:function(){m.activeSide&&("white"===m.activeSide?(o=performance.now(),m.activeSide="black"):(l=performance.now(),m.activeSide="white"))},clear(){clearInterval(c)}}}(6e4*Number(i.clock.bronstein.time()),1e3*Number(i.clock.bronstein.increment()),e,!0),hourglass:e=>function(e,t,i){let n,c,l,o={clockType:"hourglass",whiteTime:e/2,blackTime:e/2,activeSide:void 0,flagged:void 0,isRunning:!1};function m(){const m=performance.now();if("white"===s()){const a=m-c;c=m,o.whiteTime=Math.max(o.whiteTime-a,0),o.blackTime=e-o.whiteTime,d()<=0&&(o.flagged="white",t(o.flagged),i&&r.dong(),clearInterval(n))}else if("black"===s()){const c=m-l;l=m,o.blackTime=Math.max(o.blackTime-c,0),o.whiteTime=e-o.blackTime,v()<=0&&(o.flagged="black",t(o.flagged),i&&r.dong(),clearInterval(n))}a()}function s(){return o.activeSide}function u(){return o.flagged}function g(){return o.isRunning}function d(){return o.whiteTime}function v(){return o.blackTime}return{clockType:"hourglass",getState:function(){return o},setState:function(e){o=e},activeSide:s,flagged:u,isRunning:g,clockHit:function(e){u()||(i&&r.clock(),"white"===e?(l=performance.now(),o.activeSide="black"):(c=performance.now(),o.activeSide="white"),n&&clearInterval(n),n=setInterval(m,100),o.isRunning=!0,a())},startStop:function(){g()?(o.isRunning=!1,clearInterval(n)):(o.isRunning=!0,n=setInterval(m,100),"white"===s()?c=performance.now():l=performance.now())},whiteTime:d,blackTime:v,getTime:function(e){return"white"===e?d():v()},toggleActiveSide:function(){o.activeSide&&("white"===o.activeSide?(l=performance.now(),o.activeSide="black"):(c=performance.now(),o.activeSide="white"))},clear(){clearInterval(n)}}}(6e4*Number(i.clock.hourglass.time()),e,!0),stage:e=>function(e,t,i,n){let c,l,o,m={clockType:"stage",whiteTime:6e4*Number(e[0].time),blackTime:6e4*Number(e[0].time),whiteMoves:Number(e[0].moves),blackMoves:Number(e[0].moves),whiteStage:0,blackStage:0,stages:e,increment:t,activeSide:void 0,flagged:void 0,isRunning:!1};function s(){const e=performance.now();if("white"===m.activeSide){const t=e-l;l=e,m.whiteTime=Math.max(m.whiteTime-t,0),m.whiteTime<=0&&(m.flagged="white",i(m.flagged),n&&r.dong(),clearInterval(c))}else if("black"===m.activeSide){const t=e-o;o=e,m.blackTime=Math.max(m.blackTime-t,0),m.blackTime<=0&&(m.flagged="black",i(m.flagged),n&&r.dong(),clearInterval(c))}a()}function u(){return m.flagged}function g(){return m.whiteMoves}function d(){return m.blackMoves}function v(){return m.whiteTime}function f(){return m.blackTime}return{clockType:"stage",getState:function(){return m},setState:function(e){m=e},activeSide:function(){return m.activeSide},flagged:u,isRunning:function(){return m.isRunning},clockHit:function(e){if(u())return;n&&r.clock();const t=m.whiteMoves,i=m.blackMoves;"white"===e?(null!==t&&(m.whiteMoves=t-1),m.whiteTime=m.whiteTime+m.increment,0===m.whiteMoves&&(m.whiteStage=m.whiteStage+1,m.whiteTime=m.whiteTime+6e4*Number(m.stages[m.whiteStage].time),m.whiteStage===m.stages.length-1?m.whiteMoves=null:m.whiteMoves=m.stages[m.whiteStage].moves),o=performance.now(),m.activeSide="black"):(null!==i&&(m.blackMoves=i-1),m.blackTime=m.blackTime+m.increment,0===m.blackMoves&&(m.blackStage=m.blackStage+1,m.blackTime=m.blackTime+6e4*Number(m.stages[m.blackStage].time),m.blackStage===m.stages.length-1?m.blackMoves=null:m.blackMoves=m.stages[m.blackStage].moves),l=performance.now(),m.activeSide="white"),c&&clearInterval(c),c=setInterval(s,100),m.isRunning=!0,a()},startStop:function(){m.isRunning?(m.isRunning=!1,clearInterval(c)):(m.isRunning=!0,c=setInterval(s,100),"white"===m.activeSide?l=performance.now():o=performance.now())},whiteTime:v,blackTime:f,whiteMoves:g,blackMoves:d,getTime:function(e){return"white"===e?v():f()},getMoves:function(e){return"white"===e?g():d()},toggleActiveSide:function(){m.activeSide&&("white"===m.activeSide?(o=performance.now(),m.activeSide="black"):(l=performance.now(),m.activeSide="white"))},clear(){clearInterval(c)}}}(i.clock.stage.stages().map((e=>({time:Number(e.time),moves:null!==e.moves?Number(e.moves):null}))),1e3*Number(i.clock.stage.increment()),e,!0)};export{f as a,s as c,o as f,m as i};
